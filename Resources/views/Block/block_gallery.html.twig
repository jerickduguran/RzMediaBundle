{% extends sonata_block.templates.block_base %}

{% block block %}
    {% if settings.format %}
        {% if settings.title %}
            <h3 class="sonata-media-block-media-title">{{ settings.title }}</h3>
        {% endif %}

        <div id="carousel-{{ block.id }}" class="carousel slide sonata-media-block-gallery-container"
             data-interval="{{ settings.pauseTime }}"
             {% if settings.startPaused != 1 %}data-ride="carousel"{% endif %}
                >

            <!-- Indicators -->
            <ol class="carousel-indicators">
                {% for element in elements %}
                    {{ block('element_indicator') }}
                {% endfor %}
            </ol>

            <!-- Wrapper for slides -->
            <div class="carousel-inner">
                {% for element in elements %}
                    {{ block('element_display') }}
                {% endfor %}
            </div>

            <!-- Controls -->
            <a class="left carousel-control" href="#carousel-{{ block.id }}" data-slide="prev">
                <span class="icon-chevron-left"></span>
            </a>
            <a class="right carousel-control" href="#carousel-{{ block.id }}" data-slide="next">
                <span class="icon-chevron-right"></span>
            </a>
        </div>
    {% endif %}
{% endblock %}

{% block element_indicator %}
    <li data-target="#carousel-{{ block.id }}" data-slide-to="{{ loop.index0 }}"{% if loop.first %} class="active"{% endif %}></li>
{% endblock element_indicator %}

{% block element_display %}
    <div class="item{% if loop.first %} active{% endif %}">
        {% if element.media %}
            {% if settings.format is not null and settings.format != 'reference'%}
                {% media element.media, settings.format %}
            {% else %}
                {# TODO: fix error temp solution #}
                {% media element.media, 'reference' %}
            {% endif %}
        {% else %}
            <p>No media selected....</p>
        {% endif %}

        {% if element.title and  element.caption %}
        <div class="carousel-caption">
            <h4>{{ element.title }}</h4>
            <p>{{ element.caption }}</p>
        </div>
        {% endif %}
    </div>
{% endblock element_display %}